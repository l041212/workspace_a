<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/css/font-awesome.min.css}">
    <link rel="stylesheet" th:href="@{/css/ace/ace.min.css}">
</head>
<body class="no-skin">
<div class="main-container" id="main-container">
    <div class="main-content">
        <div class="main-content-inner">
            <div class="page-content">
                <div class="row">
                    <div class="col-xs-12">
                        <form enctype="multipart/form-data" th:action="@{/customer/uploadExcel}" name="Form" id="Form" method="post" >
                            <div id="zhongxin">
                                <table style="width:95%;" >
                                    <tr>
                                        <td style="padding-top: 20px;">
                                            <input type="file" id="excel" name="excel" style="width:50px;" onchange="fileType(this)" />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="text-align: center;padding-top: 10px;">
                                            <a class="btn btn-mini btn-primary" onclick="save();">导入</a>
                                            <a class="btn btn-mini btn-danger" onclick="top.Dialog.close();">取消</a>
                                            <a class="btn btn-mini btn-success" href="/upload/importTemplate/customer.xls">下载模版</a>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div id="zhongxin2" class="center" style="display:none"><br/><img th:src="@{/img/jzx.gif}" /><br/><h4 class="lighter block green"></h4></div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script th:src="@{/js/jquery-1.7.2.js}"></script>
<script th:src="@{/js/ace/ace.min.js}"></script>
<script th:src="@{/plugins/fileInput/elements.fileinput.js}"></script>
<script th:src="@{/plugins/tips/jquery.tips.js}"></script>
<script>
$(function() {
    top.hideMask();
    $('#excel').ace_file_input({
        no_file:'请选择EXCEL ...',
        btn_choose:'选择',
        btn_change:'更改',
        droppable:false,
        onchange:null,
        thumbnail:false, //| true | large
        whitelist:'xls|xls',
        blacklist:'gif|png|jpg|jpeg'
        //onchange:''
    });
});
function fileType(obj){
    var fileType=obj.value.substr(obj.value.lastIndexOf(".")).toLowerCase();//获得文件后缀名
    if(fileType != '.xls'){
        $("#excel").tips({
            side:3,
            msg:'请上传xls格式的文件',
            bg:'#AE81FF',
            time:3
        });
        $("#excel").val('');
        document.getElementById("excel").files[0] = '请选择xls格式的文件';
    }
}

//保存
function save(){
    if($("#excel").val()=="" || document.getElementById("excel").files[0] =='请选择xls格式的文件'){
        $("#excel").tips({
            side:3,
            msg:'请选择文件',
            bg:'#AE81FF',
            time:3
        });
        return false;
    }
    $("#Form").submit();
    $("#zhongxin").hide();
    $("#zhongxin2").show();
}
</script>
</body>
</html>